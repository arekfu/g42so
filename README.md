t4g4
====

This is `t4g4`, a simple Python script that compiles
[Geant4](http://geant4.cern.ch/) detector-construction and
primary-generator-action classes, wraps them in C-style (unmangled) adapter
functions and produces a shared library. The library can then be loaded via
`dlopen` by third-party code, allowing instantiation of a Geant4 detector
construction or primary generator action even if the name of the specific class
is not known in advance.

Compilation is delegated to [`g++`](http://gcc.gnu.org/) by default (no, I did
not reimplement `gcc` from scratch), but this can be configured.

Running `./t4g4 -h` gives a list of available options. You will typically want
to run something along the lines of the following:

    $ ./t4g4 -I /path/to/include/ /path/to/src/MyDetectorConstruction.cc /path/to/src/MyPrimaryGeneratorAction.cc


Notes
-----

Geant4 must be installed and the `geant4-config` script must be in the `$PATH`,
or its location can be specified with the `--geant4-config` option.

`t4g4` tries to automatically detect the names of the classes you want to wrap.
If it fails or is unsure, it will ask you to explicitly specify your class
names.

If your class constructors require arguments, you will need to customise the C
wrappers generated by the code. First run

    $ ./t4g4 --dump-detector-wrapper >detectorWrapper.cc

to dump the relevant wrapper. Modify it to your needs and pass it to `t4g4`
along with the `--custom-detector-wrapper` option, which tells `t4g4` not to
include its default wrapper. For instance:

    $ ./t4g4 --custom-detector-wrapper -I /path/to/include/ \
      /path/to/src/MyDetectorConstruction.cc detectorWrapper.cc

The `--dump-pga-wrapper` and `--custom-pga-wrapper` do the same job for
primary-generator-action classes.
